# How to import protos 

## Import envoy api

1. Verify which version of protos does grpc java use 
  - open https://github.com/grpc/grpc-java/blob/master/xds/third_party/envoy/import.sh
  - search for commit hash eg. `VERSION=b16ce6d5ea0d2da73e764d145623e7367dc59ed3`
2. Copy proto files
  - clone repository `https://github.com/envoyproxy/envoy.git`
  - set local branch to commit verified in step one
  - open repository
  - navigate to `api` folder
  - copy `envoy` folder and paste it to `Protos`
3. Remove unwanted files
  - recursively remove `BUILD` files generated by `tools/proto_sync.py`

## Import udpa

1. Verify which version of protos does grpc java use 
  - open https://github.com/grpc/grpc-java/blob/master/xds/third_party/udpa/import.sh
  - search for commit hash eg. `VERSION=edbea6a78f6d1ba34edc69c53a396b1d88d59651`
2. Copy proto files
  - clone repository `https://github.com/cncf/udpa.git`
  - set local branch to commit verified in step one. Note: Java selectively picks envoy proto files, udpa they point to may be a bit stale. 
    In case of compilation issues use latest commit of udpa repository.
  - open repository
  - copy `udpa` folder and paste it to `Protos`
3. Remove unwanted files
  - recursively remove `BUILD` files generated by `tools/proto_sync.py`

## Import protoc-gen-validate

1. Verify which version of protos does grpc java use 
  - open https://github.com/grpc/grpc-java/blob/master/xds/third_party/protoc-gen-validate/import.sh
  - search for commit hash eg. `GIT_ORIGIN_REV_ID=ab56c3dd1cf9b516b62c5087e1ec1471bd63631e`
2. Copy proto files
  - clone repository `https://github.com/envoyproxy/protoc-gen-validate.git`
  - set local branch to commit verified in step one
  - open repository
  - copy `validate` folder and paste it to `Protos` (note: copy only *.proto files)

## Import grpclb proto

1. Copy proto file
 - copy single file from https://github.com/grpc/grpc-proto/blob/master/grpc/lb/v1/load_balancer.proto
 - paste file into `grpclb` folder

## Remove unwanted files commands

__Powershell__
```
cd Protos
Get-ChildItem . -recurse -include BUILD | remove-item
```

__Unix__
```
cd Protos
find . -name "BUILD" -type f -delete
```